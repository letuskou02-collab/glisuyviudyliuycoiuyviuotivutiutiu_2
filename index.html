<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#003087" />
  <meta name="description" content="日本の一般国道ステッカーの取得状況を記録するPWAアプリ" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="国道ステッカー" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icons/icon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <link rel="stylesheet" href="./style.css" />
  <title>国道ステッカーコレクション</title>
</head>
<body>

  <!-- ステータスバー補填 -->
  <div class="status-bar-fill"></div>

  <!-- ページコンテナ -->
  <main class="app-body" id="app-body">

    <!-- ===== メニュー（初回起動） ===== -->
    <div id="view-menu" class="view-page menu-page" style="display:none">
      <div class="menu-hero">
        <div class="menu-logo">
          <!-- 日本の国道標識（1号） -->
          <svg viewBox="0 0 120 130" width="110" height="119" xmlns="http://www.w3.org/2000/svg" aria-label="国道1号">
            <!-- 外枠（白） -->
            <path d="M60 4 L116 34 L116 126 L4 126 L4 34 Z" fill="white" />
            <!-- 本体（青） -->
            <path d="M60 13 L108 40 L108 118 L12 118 L12 40 Z" fill="#005bac" />
            <!-- 路線番号 -->
            <text x="60" y="97" text-anchor="middle" font-family="'Arial Black', 'Helvetica Neue', sans-serif" font-weight="900" font-size="68" fill="white" letter-spacing="-2">1</text>
          </svg>
        </div>
        <h1 class="menu-title">国道ステッカー<br>コレクション</h1>
        <p class="menu-sub">日本全国の国道ステッカーを集めよう</p>
      </div>
      <div class="menu-cards">
        <button class="menu-card" data-goto="home">
          <span class="menu-card-icon">🏠</span>
          <div class="menu-card-body">
            <div class="menu-card-title">ホーム</div>
            <div class="menu-card-desc">進捗サマリー・最近の取得</div>
          </div>
          <span class="menu-card-arrow">›</span>
        </button>
        <button class="menu-card" data-goto="list">
          <span class="menu-card-icon">📋</span>
          <div class="menu-card-body">
            <div class="menu-card-title">登録</div>
            <div class="menu-card-desc">国道ステッカーの取得を記録</div>
          </div>
          <span class="menu-card-arrow">›</span>
        </button>
        <button class="menu-card" data-goto="map">
          <span class="menu-card-icon">🗺</span>
          <div class="menu-card-body">
            <div class="menu-card-title">地図</div>
            <div class="menu-card-desc">取得場所をマップで確認</div>
          </div>
          <span class="menu-card-arrow">›</span>
        </button>
        <button class="menu-card" data-goto="gallery">
          <span class="menu-card-icon">📸</span>
          <div class="menu-card-body">
            <div class="menu-card-title">一覧</div>
            <div class="menu-card-desc">国道名・場所・写真を一覧表示</div>
          </div>
          <span class="menu-card-arrow">›</span>
        </button>
        <button class="menu-card" data-goto="other">
          <span class="menu-card-icon">⚙</span>
          <div class="menu-card-body">
            <div class="menu-card-title">その他</div>
            <div class="menu-card-desc">データ管理・エクスポート</div>
          </div>
          <span class="menu-card-arrow">›</span>
        </button>
      </div>
    </div>

    <!-- ===== ホーム ===== -->
    <div id="view-home" class="view-page">

      <!-- 進捗カード -->
      <div class="home-progress-card">
        <div class="progress-nums">
          <span class="big" id="stat-collected">0</span>
          <span class="slash">/</span>
          <span class="total" id="stat-total">0</span>
          <span class="pct" id="stat-pct">0%</span>
        </div>
        <div class="progress-bar-track">
          <div class="progress-bar-fill" id="progress-bar" style="width:0%"></div>
        </div>
        <div class="progress-label">取得済み</div>
      </div>

      <!-- 地方別サマリー -->
      <section class="home-section">
        <div class="home-section-title">地方別進捗</div>
        <div class="region-cards-scroll" id="region-cards"></div>
      </section>

      <!-- 最近の取得 -->
      <section class="home-section">
        <div class="home-section-title">最近の取得</div>
        <div id="recent-list" class="recent-list"></div>
      </section>
    </div>

    <!-- ===== 登録（国道一覧） ===== -->
    <div id="view-list" class="view-page" style="display:none">
      <div class="page-header">
        <h2>📋 登録</h2>
      </div>

      <div class="list-toolbar">
        <div class="search-bar">
          <span class="search-icon">🔍</span>
          <input type="search" id="search-input" placeholder="号数・地方・区間で検索…" autocomplete="off" />
        </div>
        <div class="filter-tabs">
          <button class="tab-btn active" data-filter="all">すべて</button>
          <button class="tab-btn" data-filter="collected">取得済み</button>
          <button class="tab-btn" data-filter="not-collected">未取得</button>
        </div>
        <div class="select-row">
          <select id="region-select">
            <option value="">地方：すべて</option>
            <option value="北海道">北海道</option>
            <option value="東北">東北</option>
            <option value="関東">関東</option>
            <option value="中部">中部</option>
            <option value="北陸">北陸</option>
            <option value="近畿">近畿</option>
            <option value="中国">中国</option>
            <option value="四国">四国</option>
            <option value="九州">九州</option>
            <option value="沖縄">沖縄</option>
          </select>
          <select id="type-select">
            <option value="">種別：すべて</option>
            <option value="一桁">一桁国道</option>
            <option value="二桁">二桁国道</option>
            <option value="三桁">三桁国道</option>
          </select>
        </div>
        <div class="toolbar-right">
          <span id="section-count" class="section-count"></span>
          <div class="view-toggle">
            <button class="active" id="btn-grid-view" title="グリッド">⊞</button>
            <button id="btn-list-view" title="リスト">≡</button>
          </div>
        </div>
      </div>

      <div id="routes-container" class="routes-grid"></div>
    </div>

    <!-- ===== 地図 ===== -->
    <div id="view-map" class="view-page" style="display:none">
      <div class="map-page-header">
        <h2>🗺 地図</h2>
        <div class="map-filter-row">
          <button class="map-filter-btn active" data-mfilter="collected">✅ 取得済み</button>
          <button class="map-filter-btn" data-mfilter="all">📋 すべて</button>
        </div>
      </div>
      <div id="map-pin-count"></div>
      <div id="map-container"></div>
    </div>

    <!-- ===== 一覧 ===== -->
    <div id="view-gallery" class="view-page" style="display:none">
      <div class="page-header">
        <h2>📸 一覧</h2>
      </div>
      <div id="gallery-container" class="gallery-grid"></div>
    </div>

    <!-- ===== その他 ===== -->
    <div id="view-other" class="view-page other-page" style="display:none">
      <div class="page-header">
        <h2>⚙ その他</h2>
      </div>

      <div class="other-section">
        <div class="other-group-label">データ管理</div>
        <div class="other-group">
          <div class="other-row" id="btn-export">
            <span class="other-row-icon">📤</span>
            <div class="other-row-body">
              <div class="other-row-title">エクスポート</div>
              <div class="other-row-desc">JSONファイルとして保存</div>
            </div>
            <span class="arrow">›</span>
          </div>
          <div class="other-row" id="btn-import">
            <span class="other-row-icon">📥</span>
            <div class="other-row-body">
              <div class="other-row-title">インポート</div>
              <div class="other-row-desc">JSONファイルから復元</div>
            </div>
            <span class="arrow">›</span>
          </div>
        </div>

        <div class="other-group-label">危険な操作</div>
        <div class="other-group">
          <div class="other-row danger" id="btn-reset">
            <span class="other-row-icon">🗑️</span>
            <div class="other-row-body">
              <div class="other-row-title">すべてリセット</div>
              <div class="other-row-desc">全記録を削除（元に戻せません）</div>
            </div>
            <span class="arrow">›</span>
          </div>
        </div>

        <div class="other-group-label">アプリについて</div>
        <div class="other-info">
          国道ステッカーコレクション<br>
          日本全国の一般国道ステッカー収集記録アプリ
        </div>
      </div>
    </div>

  </main>

  <!-- ボトムタブバー -->
  <nav class="bottom-tab-bar">
    <button class="tab-item active" data-view="home">
      <span class="tab-icon">🏠</span>
      <span class="tab-label">ホーム</span>
    </button>
    <button class="tab-item" data-view="list">
      <span class="tab-icon">📋</span>
      <span class="tab-label">登録</span>
    </button>
    <button class="tab-item" data-view="map">
      <span class="tab-icon">🗺</span>
      <span class="tab-label">地図</span>
    </button>
    <button class="tab-item" data-view="gallery">
      <span class="tab-icon">📸</span>
      <span class="tab-label">一覧</span>
    </button>
    <button class="tab-item" data-view="other">
      <span class="tab-icon">⚙</span>
      <span class="tab-label">その他</span>
    </button>
  </nav>

  <!-- ===== モーダル ===== -->
  <div id="modal-overlay" class="modal-overlay" role="dialog" aria-modal="true">
    <div class="modal-sheet">
      <div class="modal-handle"></div>
      <div class="modal-header">
        <div class="modal-route-num" id="modal-route-num">国道1号</div>
        <div class="modal-route-info">
          <div class="modal-route-region" id="modal-route-region"></div>
          <div class="modal-route-path">
            起点：<span id="modal-route-from"></span>　終点：<span id="modal-route-to"></span>
          </div>
        </div>
        <button id="modal-close" aria-label="閉じる">✕</button>
      </div>

      <div class="modal-section">
        <div class="modal-section-label">取得状況</div>
        <button class="collect-toggle" id="collect-toggle-btn">○ 取得済みにする</button>
        <div id="modal-date"></div>
      </div>

      <div class="modal-section">
        <div class="modal-section-label">取得場所</div>
        <div class="modal-field">
          <label for="modal-location-input">施設名・場所</label>
          <div class="location-row">
            <input type="text" id="modal-location-input" placeholder="例：道の駅〇〇、△△SA" />
            <button id="btn-geocode" title="施設名から緯度経度を検索">🔍</button>
          </div>
        </div>
        <div class="modal-field">
          <label>緯度・経度</label>
          <div class="coords-row">
            <input type="number" id="modal-lat-input" placeholder="緯度 (35.68…)" step="0.000001" />
            <input type="number" id="modal-lng-input" placeholder="経度 (139.76…)" step="0.000001" />
          </div>
          <a id="modal-map-link" href="#" target="_blank" rel="noopener">🗺 地図で確認</a>
        </div>
      </div>

      <div class="modal-section">
        <div class="modal-section-label">写真</div>
        <div class="photo-grid" id="photo-grid"></div>
        <div class="photo-add-btns">
          <label class="photo-add-btn" for="photo-input-camera">
            📷 カメラ
            <input type="file" id="photo-input-camera" accept="image/*" capture="environment" style="display:none" />
          </label>
          <label class="photo-add-btn" for="photo-input-library">
            🖼 ライブラリ
            <input type="file" id="photo-input-library" accept="image/*" multiple style="display:none" />
          </label>
          <label class="photo-add-btn" for="photo-input-file">
            📁 ファイル
            <input type="file" id="photo-input-file" accept="image/*" multiple style="display:none" />
          </label>
        </div>
      </div>

      <div class="modal-section">
        <div class="modal-section-label">メモ</div>
        <div class="modal-field">
          <textarea id="modal-memo-input" placeholder="自由にメモを入力…"></textarea>
        </div>
      </div>

    </div>
  </div>

  <!-- トースト -->
  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV/XN/WLaQ=" crossorigin=""></script>
  <script src="./data/routes.js"></script>
  <script src="./app.js"></script>
</body>
</html>
